{% extends "master/sideBar/sidebar_administrador.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
{% include "master/appBar/appBar_Admin.html" %}

<style>
    @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap');

    :root {
        --glass-bg: rgba(255, 255, 255, 0.75);
        --glass-border: rgba(148, 163, 184, 0.22);
        --glass-shadow: 0 22px 44px rgba(15, 23, 42, 0.16);
        --ink: #0f172a;
        --muted: #64748b;
    }

    .ui-shell {
        background:
            radial-gradient(900px 420px at 12% 8%, rgba(16, 185, 129, 0.16), transparent 55%),
            radial-gradient(980px 520px at 88% 18%, rgba(34, 197, 94, 0.14), transparent 60%),
            radial-gradient(860px 420px at 70% 90%, rgba(20, 184, 166, 0.12), transparent 60%),
            linear-gradient(135deg, #f8fafc 0%, #eef2ff 35%, #f0fdf4 100%);
        position: relative;
        overflow: hidden;
        font-family: 'Manrope', 'Segoe UI', sans-serif;
    }

    .ui-shell::after {
        content: "";
        position: absolute;
        inset: 0;
        opacity: 0.06;
        pointer-events: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.6'/%3E%3C/svg%3E");
    }

    .ui-container {
        max-width: 1180px;
        margin: 0 auto;
    }

    .ui-card {
        background: linear-gradient(180deg, var(--glass-bg) 0%, rgba(255, 255, 255, 0.62) 100%);
        border: 1px solid var(--glass-border);
        border-radius: 24px;
        box-shadow: var(--glass-shadow);
        backdrop-filter: blur(12px);
    }

    .ui-title {
        font-size: 28px;
        font-weight: 800;
        color: var(--ink);
        letter-spacing: -0.03em;
    }

    .ui-subtitle {
        font-size: 14px;
        color: var(--muted);
    }

    .ui-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: rgba(15, 23, 42, 0.08);
        color: var(--ink);
    }

    .ui-icon svg {
        width: 20px;
        height: 20px;
    }

    .ui-badge {
        display: inline-flex;
        align-items: center;
        padding: 4px 12px;
        border-radius: 999px;
        font-size: 10px;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        font-weight: 700;
        border: 1px solid transparent;
    }

    .ui-badge-muted {
        background: rgba(148, 163, 184, 0.12);
        color: #64748b;
        border-color: rgba(148, 163, 184, 0.3);
    }

    .ui-badge-info {
        background: rgba(34, 197, 94, 0.15);
        color: #166534;
        border-color: rgba(34, 197, 94, 0.35);
    }

    .ui-badge-success {
        background: rgba(16, 185, 129, 0.16);
        color: #065f46;
        border-color: rgba(16, 185, 129, 0.35);
    }

    .ui-kpi-label {
        font-size: 11px;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: #94a3b8;
    }

    .ui-kpi-value {
        font-size: 30px;
        font-weight: 800;
        color: var(--ink);
    }
</style>

<div class="ui-shell p-6 md:p-10">
    <div class="ui-container space-y-6">
        <div class="ui-card p-6">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <div class="flex items-center gap-3">
                        <span class="ui-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                                <path d="M4 7h16M4 12h10M4 17h7" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </span>
                        <h1 class="ui-title">Panel de administracion</h1>
                    </div>
                    <p class="ui-subtitle mt-2">Estado global del sistema, operaciones y finanzas.</p>
                </div>
                <div class="ui-badge ui-badge-muted">Vista general</div>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4">
            <div class="ui-card p-6">
                <div class="ui-kpi-label">Polizas activas</div>
                <div class="mt-3 ui-kpi-value">{{ polizas_activas }}</div>
                <div class="mt-2 text-xs text-slate-400">Total polizas: {{ total_polizas }}</div>
            </div>
            <div class="ui-card p-6">
                <div class="ui-kpi-label">Siniestros pendientes</div>
                <div class="mt-3 ui-kpi-value">{{ siniestros_pendientes }}</div>
                <div class="mt-2 text-xs text-slate-400">Total siniestros: {{ total_siniestros }}</div>
            </div>
            <div class="ui-card p-6">
                <div class="ui-kpi-label">Solicitudes pendientes</div>
                <div class="mt-3 ui-kpi-value">{{ solicitudes_pendientes }}</div>
                <div class="mt-2 text-xs text-slate-400">Total solicitudes: {{ total_solicitudes }}</div>
            </div>
            <div class="ui-card p-6">
                <div class="ui-kpi-label">Notificaciones sin leer</div>
                <div class="mt-3 ui-kpi-value">{{ notificaciones_pendientes }}</div>
                <div class="mt-2 text-xs text-slate-400">Alertas operativas</div>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4 lg:grid-cols-3">
            <div class="ui-card p-6 lg:col-span-2">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-semibold text-slate-900">Finanzas y liquidaciones</h2>
                    <span class="ui-badge ui-badge-info">Facturas y pagos</span>
                </div>
                <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-3">
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3">
                        <div class="ui-kpi-label">Total facturado</div>
                        <div class="mt-2 text-2xl font-bold text-slate-900">${{ total_facturado|floatformat:2 }}</div>
                    </div>
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3">
                        <div class="ui-kpi-label">Total pagado</div>
                        <div class="mt-2 text-2xl font-bold text-slate-900">${{ total_pagado|floatformat:2 }}</div>
                    </div>
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3">
                        <div class="ui-kpi-label">Saldo pendiente</div>
                        <div class="mt-2 text-2xl font-bold text-slate-900">${{ saldo_pendiente|floatformat:2 }}</div>
                    </div>
                </div>
                <div class="mt-4 grid grid-cols-1 gap-4 md:grid-cols-2">
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Facturas registradas: <span class="font-semibold text-slate-900">{{ facturas_total }}</span>
                    </div>
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Pagos registrados: <span class="font-semibold text-slate-900">{{ pagos_total }}</span>
                    </div>
                </div>
            </div>

            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Aseguradoras</h2>
                <div class="mt-4 space-y-3">
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Total aseguradoras
                        <span class="font-semibold text-slate-900">{{ aseguradoras_total }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Activas
                        <span class="font-semibold text-emerald-700">{{ aseguradoras_activas }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Inactivas
                        <span class="font-semibold text-slate-900">{{ aseguradoras_inactivas }}</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4 lg:grid-cols-3">
            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Polizas</h2>
                <div class="mt-4 space-y-3">
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Pendientes
                        <span class="font-semibold text-slate-900">{{ polizas_pendientes }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Vencidas
                        <span class="font-semibold text-slate-900">{{ polizas_vencidas }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Estudiantes activos
                        <span class="font-semibold text-slate-900">{{ estudiantes_activos }}</span>
                    </div>
                </div>
            </div>

            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Siniestros</h2>
                <div class="mt-4 space-y-3">
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Aprobados
                        <span class="font-semibold text-emerald-700">{{ siniestros_aprobados }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Rechazados
                        <span class="font-semibold text-slate-900">{{ siniestros_rechazados }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Pagados
                        <span class="font-semibold text-slate-900">{{ siniestros_pagados }}</span>
                    </div>
                </div>
            </div>

            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Solicitudes</h2>
                <div class="mt-4 space-y-3">
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        En proceso
                        <span class="font-semibold text-slate-900">{{ solicitudes_en_proceso }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Aprobadas
                        <span class="font-semibold text-emerald-700">{{ solicitudes_aprobadas }}</span>
                    </div>
                    <div class="flex items-center justify-between rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        Rechazadas
                        <span class="font-semibold text-slate-900">{{ solicitudes_rechazadas }}</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="ui-card p-6">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-900">Documentos y requisitos</h2>
                <span class="ui-badge ui-badge-muted">Control documental</span>
            </div>
            <div class="mt-4 grid grid-cols-1 gap-4 md:grid-cols-5">
                <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                    Requeridos <span class="font-semibold text-slate-900">{{ documentos_requeridos }}</span>
                </div>
                <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                    Activos <span class="font-semibold text-slate-900">{{ documentos_activos }}</span>
                </div>
                <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                    Pendientes <span class="font-semibold text-slate-900">{{ documentos_pendientes }}</span>
                </div>
                <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                    Aprobados <span class="font-semibold text-slate-900">{{ documentos_aprobados }}</span>
                </div>
                <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                    Rechazados <span class="font-semibold text-slate-900">{{ documentos_rechazados }}</span>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4 lg:grid-cols-3">
            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Ultimas polizas</h2>
                <div class="mt-4 space-y-3">
                    {% for poliza in recent_polizas %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        <div class="font-semibold text-slate-900">{{ poliza.numero_poliza }}</div>
                        <div class="text-xs text-slate-400">{{ poliza.get_estado_display }} | {{ poliza.aseguradora.nombre|default:"Sin aseguradora" }}</div>
                    </div>
                    {% empty %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-500">
                        No hay polizas registradas.
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Ultimos siniestros</h2>
                <div class="mt-4 space-y-3">
                    {% for siniestro in recent_siniestros %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        <div class="font-semibold text-slate-900">#{{ siniestro.id }} - {{ siniestro.get_tipo_display }}</div>
                        <div class="text-xs text-slate-400">Estado: {{ siniestro.get_estado_display }}</div>
                    </div>
                    {% empty %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-500">
                        No hay siniestros registrados.
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="ui-card p-6">
                <h2 class="text-lg font-semibold text-slate-900">Ultimas solicitudes</h2>
                <div class="mt-4 space-y-3">
                    {% for solicitud in recent_solicitudes %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-600">
                        <div class="font-semibold text-slate-900">Solicitud #{{ solicitud.id }}</div>
                        <div class="text-xs text-slate-400">{{ solicitud.estudiante.nombres }} {{ solicitud.estudiante.apellidos }} | {{ solicitud.get_estado_display }}</div>
                    </div>
                    {% empty %}
                    <div class="rounded-xl border border-slate-100 bg-white/70 px-4 py-3 text-sm text-slate-500">
                        No hay solicitudes registradas.
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
