{% extends "master/sideBar/sidebar_administrador.html" %}

{% block title %}Aseguradoras{% endblock %}

{% block content %}
{% include "master/appBar/appBar_Admin.html" %}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap');

  :root{
    --primary:#14b8a6;
    --primary-dark:#0d9488;
    --primary-light:#5eead4;

    --glass-teal: rgba(20, 184, 166, 0.12);
    --glass-emerald: rgba(16, 185, 129, 0.12);

    --border-teal: rgba(94, 234, 212, 0.25);
    --border-emerald: rgba(110, 231, 183, 0.25);

    --text-primary:#0f172a;
    --text-secondary:#475569;
    --text-muted:#64748b;
  }

  .ui-shell{
    background: linear-gradient(135deg, #e0f2fe 0%, #ecfdf5 25%, #f0fdfa 50%, #f0fdf4 75%, #ecfccb 100%);
    position: relative;
    overflow: hidden;
    min-height: 100vh;
    font-family: 'Manrope','Segoe UI',sans-serif;
  }
  .ui-shell::before{
    content:"";
    position:absolute; inset:0;
    opacity:.4;
    background-image:
      radial-gradient(circle at 20% 30%, rgba(94, 234, 212, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 70%, rgba(167, 243, 208, 0.12) 0%, transparent 50%),
      radial-gradient(circle at 50% 50%, rgba(20, 184, 166, 0.1) 0%, transparent 50%);
  }
  .ui-shell::after{
    content:"";
    position:absolute; inset:0;
    opacity:.03;
    pointer-events:none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='2'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23n)' opacity='.5'/%3E%3C/svg%3E");
  }

  .ui-container{
    max-width: 1280px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  .header-card{
    background: rgba(255,255,255,.7);
    border: 1px solid rgba(148,163,184,.2);
    border-radius: 20px;
    box-shadow: 0 4px 16px rgba(15,23,42,.06), inset 0 1px 0 rgba(255,255,255,.5);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    position: relative;
    overflow: hidden;
  }
  .header-card::before{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(circle at 15% 20%, rgba(255, 255, 255, 0.4) 0%, transparent 12%),
      radial-gradient(circle at 85% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 10%);
    pointer-events:none;
  }

  .ui-title{
    font-size: 32px;
    font-weight: 800;
    color: var(--text-primary);
    letter-spacing: -0.02em;
  }
  .ui-subtitle{
    font-size: 14px;
    color: var(--text-muted);
    font-weight: 500;
  }

  .ui-icon{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width: 48px;
    height: 48px;
    border-radius: 14px;
    background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
    color: white;
    box-shadow: 0 4px 12px rgba(20,184,166,.3);
  }
  .ui-icon svg{ width: 24px; height: 24px; }

  .ui-badge{
    display:inline-flex;
    align-items:center;
    padding: 6px 16px;
    border-radius: 999px;
    font-size: 10px;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-weight: 700;
    background: rgba(148,163,184,.1);
    border: 1px solid rgba(148,163,184,.2);
    color: #475569;
  }
  .ui-badge-info{
    background: rgba(20,184,166,.1);
    border-color: rgba(20,184,166,.2);
    color: #0d9488;
  }

  .simple-card{
    background: white;
    border: 1px solid rgba(226,232,240,.8);
    border-radius: 16px;
    box-shadow: 0 1px 3px rgba(15,23,42,.06);
    transition: all .2s ease;
    overflow: hidden;
  }
  .simple-card:hover{
    border-color: rgba(148,163,184,.3);
    box-shadow: 0 4px 12px rgba(15,23,42,.08);
  }

  /* Tabla */
  .table-top{
    padding: 1rem 1.25rem;
    border-bottom: 1px solid rgba(226,232,240,.8);
    background: linear-gradient(to right, rgba(241,245,249,.55), rgba(248,250,252,.55));
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 1rem;
  }
  .table-title{
    font-size: 16px;
    font-weight: 800;
    color: var(--text-primary);
  }

  .ui-btn{
    display:inline-flex;
    align-items:center;
    gap:.55rem;
    padding: .65rem 1rem;
    border-radius: 14px;
    font-size: 11px;
    font-weight: 800;
    letter-spacing: .14em;
    text-transform: uppercase;
    border: 1px solid rgba(148,163,184,.25);
    background: rgba(255,255,255,.75);
    box-shadow: 0 4px 14px rgba(15,23,42,.06);
    transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  }
  .ui-btn:hover{
    transform: translateY(-1px);
    border-color: rgba(20,184,166,.25);
    box-shadow: 0 8px 18px rgba(15,23,42,.08);
  }
  .ui-btn-primary{
    border-color: rgba(20,184,166,.25);
    background: rgba(20,184,166,.10);
    color: #0d9488;
  }
  .ui-btn-primary svg{ stroke: #0d9488; }

  .ui-table{
    width: 100%;
    border-collapse: collapse;
  }
  .ui-table thead th{
    text-align:left;
    font-size: 11px;
    letter-spacing: .15em;
    text-transform: uppercase;
    font-weight: 800;
    color: var(--text-muted);
    padding: .95rem 1.25rem;
    background: rgba(248,250,252,.9);
    border-bottom: 1px solid rgba(226,232,240,.8);
  }
  .ui-table tbody td{
    padding: .95rem 1.25rem;
    border-bottom: 1px solid rgba(226,232,240,.8);
    color: var(--text-secondary);
    vertical-align: top;
  }
  .ui-table tbody tr:hover{
    background: rgba(241,245,249,.55);
  }

  .name{
    font-weight: 800;
    color: var(--text-primary);
  }
  .sub{
    font-size: 12px;
    color: var(--text-muted);
    margin-top: .15rem;
  }

  .pill{
    display:inline-flex;
    align-items:center;
    gap:.45rem;
    padding: 6px 14px;
    border-radius: 999px;
    font-size: 10px;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-weight: 800;
    border: 1px solid rgba(148,163,184,.2);
    background: rgba(148,163,184,.08);
    color: #475569;
  }
  .pill-success{
    background: rgba(16,185,129,.10);
    border-color: rgba(16,185,129,.20);
    color: #059669;
  }
  .dot{
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: currentColor;
    opacity: .75;
  }

  .actions{
    display:flex;
    justify-content:flex-end;
    gap:.55rem;
    flex-wrap: wrap;
  }
  .a-link{
    display:inline-flex;
    align-items:center;
    gap:.45rem;
    padding: .5rem .75rem;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 800;
    color: #0f172a;
    border: 1px solid rgba(226,232,240,.9);
    background: rgba(248,250,252,.9);
    transition: transform .14s ease, border-color .14s ease, background .14s ease;
  }
  .a-link:hover{
    transform: translateY(-1px);
    border-color: rgba(20,184,166,.25);
    background: white;
  }
  .a-link svg{ width: 16px; height: 16px; }

  .empty{
    padding: 2.5rem 1.25rem;
    text-align:center;
    color: var(--text-muted);
  }

  @media (max-width: 640px){
    .ui-title{ font-size: 26px; }
    .ui-table thead{ display:none; }
    .ui-table, .ui-table tbody, .ui-table tr, .ui-table td{ display:block; width:100%; }
    .ui-table tbody td{ border-bottom: none; padding: .6rem 1rem; }
    .ui-table tbody tr{
      border-bottom: 1px solid rgba(226,232,240,.8);
      padding: .6rem 0;
    }
    .actions{ justify-content:flex-start; padding: .2rem 1rem 1rem; }
  }
</style>

<div class="ui-shell p-6 md:p-10">
  <div class="ui-container space-y-6">

    <!-- Header -->
    <div class="header-card p-6">
      <div class="flex flex-wrap items-start justify-between gap-4">
        <div>
          <div class="flex items-center gap-3">
            <span class="ui-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                  stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <h1 class="ui-title">Gestión de aseguradoras</h1>
          </div>
          <p class="ui-subtitle mt-2">Alta, edición y estado de aseguradoras activas e históricas.</p>
        </div>

        <a href="{% url 'aseguradora_create' %}" class="ui-btn ui-btn-primary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Nueva aseguradora
        </a>
      </div>
    </div>

    {% if messages %}
      <div class="space-y-2">
        {% for message in messages %}
          <div class="simple-card p-4 text-sm text-slate-700">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Table card -->
    <div class="simple-card">
      <div class="table-top">
        <div>
          <div class="table-title">Listado operativo</div>
          <div class="text-xs text-slate-500 mt-1">Administración de aseguradoras</div>
        </div>
        <span class="ui-badge ui-badge-info">Aseguradoras</span>
      </div>

      <div class="overflow-x-auto">
        <table class="ui-table text-sm">
          <thead>
            <tr>
              <th>Aseguradora</th>
              <th>Contacto</th>
              <th>Estado</th>
              <th>Histórico</th>
              <th class="text-right">Acciones</th>
            </tr>
          </thead>

          <tbody>
            {% for aseguradora in aseguradoras %}
              <tr>
                <td>
                  <div class="name">{{ aseguradora.nombre }}</div>
                  <div class="sub">{{ aseguradora.direccion|default:"Sin dirección" }}</div>
                </td>

                <td>
                  <div class="text-slate-700">{{ aseguradora.telefono|default:"-" }}</div>
                  <div class="sub">{{ aseguradora.email|default:"-" }}</div>
                </td>

                <td>
                  {% if aseguradora.is_active %}
                    <span class="pill pill-success">
                      <span class="dot"></span> Activa
                    </span>
                  {% else %}
                    <span class="pill">
                      <span class="dot"></span> Inactiva
                    </span>
                  {% endif %}
                </td>

                <td class="text-slate-600">
                  {% if aseguradora.fecha_inactivacion %}
                    Inactiva desde {{ aseguradora.fecha_inactivacion|date:"d/m/Y" }}
                  {% else %}
                    -
                  {% endif %}
                </td>

                <td class="text-right">
                  <div class="actions">
                    <a href="{% url 'politicas_list' aseguradora.id_aseguradora %}" class="a-link">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                          stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                      Políticas
                    </a>

                    <a href="{% url 'aseguradora_edit' aseguradora.id_aseguradora %}" class="a-link">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke-linecap="round"/>
                        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"
                          stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                      Editar
                    </a>

                    <form method="POST" action="{% url 'aseguradora_toggle' aseguradora.id_aseguradora %}" class="inline">
                      {% csrf_token %}
                      <button type="submit" class="a-link" style="cursor:pointer">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M12 9v2m0 4h.01" stroke-linecap="round"/>
                          <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        {% if aseguradora.is_active %}Desactivar{% else %}Activar{% endif %}
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="empty">No hay aseguradoras registradas.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>
{% endblock %}
